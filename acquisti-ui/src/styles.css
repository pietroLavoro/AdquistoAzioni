/* ================================
   BASE + TOKENS (escala de espacios)
   ================================ */
*,
*::before,
*::after { box-sizing: border-box; }

:root{
  /* Escala */
  --s-1: .50rem;
  --s-2: 1.00rem;
  --s-3: 1.50rem;
  --s-4: 2.00rem;

  /* Layout */
  --gutter-x: var(--s-4);   /* separación entre columnas */
  --gutter-y: var(--s-3);   /* separación entre filas   */

  /* Cards */
  --card-pad-x: var(--s-3);
  --card-pad-y: var(--s-3);
  --radius: 1rem;

  /* Ritmo interno */
  --section-gap: var(--s-3); /* separación entre bloques dentro de una card */
  --field-gap:   var(--s-2); /* separación entre campos del formulario      */

  /* Página */
  --page-pad-x: 1.25rem;
  --page-pad-y: .75rem;
  --readable-max: 780px;

  /* Colores utilitarios */
  --muted: #9ca3af;
}

html, body,
.p-card, .p-panel, .p-datatable,
.p-inputtext, .p-inputnumber-input, .p-select, .p-datepicker, .card {
  transition: background .3s ease, color .3s ease, border-color .3s ease, box-shadow .3s ease, filter .2s ease;
}

body {
  margin: 0;
  font-family: var(--font-family, system-ui, sans-serif);
  padding: var(--s-2);
}

.muted { color: var(--muted); }
.err, .neg { color:#e74c3c; }
.text-right { text-align:right; }
.text-center { text-align:center; }

/* ================================
   GRID PRINCIPAL
   ================================ */
.page-grid{
  display: grid;
  grid-template-columns: minmax(0,1fr) minmax(0,1fr);
  grid-template-areas:
    "left right"
    "bottom bottom";
  column-gap: var(--gutter-x);
  row-gap: var(--gutter-y);
  align-items: stretch; /* estira ambas columnas */
  padding: var(--page-pad-y) var(--page-pad-x); /* sangría general */
}
.col.left  { grid-area: left; }
.col.right { grid-area: right; display: grid; grid-template-rows: auto minmax(0,1fr); gap: var(--section-gap); }
.bottom    { grid-area: bottom; }

/* ================================
   CARDS + HEADERS
   ================================ */
.card { border-radius: var(--radius); overflow: hidden; }
.card .p-card-body{ padding: var(--card-pad-y) var(--card-pad-x) !important; }
.card .p-card-content{ padding: 0 !important; } /* el body gobierna */

.card-header{
  display:flex; align-items:center; justify-content:space-between; gap: var(--s-2);
  padding-bottom: calc(var(--s-2) - 2px);
  margin-bottom: var(--s-2);
  border-bottom: 1px solid rgba(255,255,255,.08);
}
.title{ margin: 0 0 var(--s-2) 0; }

/* Columna izquierda ocupa todo el alto y tiene padding aunque sea <section> */
.col.left.card{ height: 100%; display:flex; flex-direction:column; }
.col.left.card.p-card{ padding: var(--card-pad-y) var(--card-pad-x); border-radius: var(--radius); }
.col.left.card .p-card-body{ display:flex; flex-direction:column; }
.col.left.card .p-card-content{ flex:1 1 auto; min-height:0; max-width: var(--readable-max); margin-right: auto; }

/* ================================
   FORM / BLOQUES INTERNOS
   ================================ */
.form-grid { display:grid; gap: var(--field-gap); }
.row-inline { display:flex; align-items:center; gap: var(--s-2); flex-wrap:wrap; }
.field { display:grid; gap:.6rem; }
.field > label { margin:0; font-weight:500; }
.actions { display:flex; gap: var(--s-2); flex-wrap:wrap; margin-top: var(--s-2); }

/* Controles a ancho completo y sin sensación de “pegados” */
.col.left.card .p-inputtext,
.col.left.card .p-inputnumber-input,
.col.left.card .p-select,
.col.left.card .p-datepicker { width: 100%; }
.col.left.card .p-input-icon-right{ padding-right: .35rem; }

/* ================================
   KPIs
   ================================ */
.kpi-row { display:grid; grid-template-columns: repeat(3,1fr); gap: var(--s-2); margin-bottom: var(--section-gap); }
.kpi .p-card { border-radius: .75rem; }
.kpi-value { font-size: 1.25rem; font-weight: 700; }
.kpi-value.pos  { color:#2ecc71; }
.kpi-value.zero { color:#f1c40f; }
.kpi-value.neg  { color:#ff6b6b; }

/* ================================
   TABLA + GRÁFICO (alturas saludables)
   ================================ */
.table-card { display:flex; flex-direction:column; min-height: 360px; }
.table-card .p-card-body{ display:flex; flex-direction:column; }
.table-card .p-card-content{ flex:1 1 auto; min-height:0; }

/* Compactar espacio entre título y tabla en “Saldos en vivo” */
.table-card .card-header{
  margin-bottom: .35rem;
  padding-bottom: .5rem;
  border-bottom: 1px solid rgba(255,255,255,.08);
}

/* p-table scrollable con header visible y sin aire extra */
.table-card ::ng-deep .p-table-scrollable-wrapper,
.table-card ::ng-deep .p-table-scrollable-view{ height: auto !important; }

.table-card ::ng-deep .p-table-scrollable-header,
.table-card ::ng-deep .p-table-scrollable-header-box{
  height: auto !important;
  overflow: visible !important;
  margin-top: 0 !important;
  padding-top: 0 !important;
  border-top: 0 !important;
}

/* El body scrollea con el alto que indiques en [scrollHeight] en el HTML */
.table-card ::ng-deep .p-table-scrollable-body{
  height: auto !important;          /* PrimeNG calcula por scrollHeight */
  max-height: none !important;
  overflow: auto;
  padding-bottom: .5rem;            /* que no corte la última fila */
}

/* Densidad/padding de celdas */
.dense ::ng-deep .p-table thead > tr > th,
.dense ::ng-deep .p-table tbody > tr > td { padding:.6rem .8rem; }
.dense ::ng-deep .p-table tbody > tr > td { font-size:.95rem; }

/* Gráfico: ocupa el alto del card de forma limpia */
.chart-card { min-height: 380px; display:flex; flex-direction:column; }
.chart-wrap { flex:1 1 auto; min-height:0; }

/* ================================
   OVERLAYS / UTILS
   ================================ */
.loading-overlay { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,.12); backdrop-filter: blur(1px); z-index:1000; }
.theme-toggle{ position:fixed; top:12px; right:12px; z-index:1100; }

/* ================================
   RESPONSIVE
   ================================ */
@media (max-width: 992px){
  .page-grid{
    grid-template-columns: 1fr;
    grid-template-areas: "left" "right" "bottom";
    column-gap: var(--s-2);
    row-gap: var(--s-2);
  }
  :root{
    --card-pad-x: var(--s-2);
    --card-pad-y: var(--s-2);
    --section-gap: var(--s-2);
    --field-gap:   var(--s-2);
    --readable-max: 100%;
  }
}

/* ================================
   DARK THEME — SOFT PALETTE
   ================================ */
html.dark {
  --soft-bg-1:#1f2430; --soft-bg-2:#262b36; --soft-card:#2b3040; --soft-border:#3a4152;
  --soft-text:#e8ebf1; --soft-muted:#b7bfd1; --soft-row-hover:#2f3546; --soft-input:#32384a;
}
html.dark body {
  background: linear-gradient(150deg, var(--soft-bg-1), var(--soft-bg-2) 45%, var(--soft-bg-1));
  color: var(--soft-text);
}
html.dark .card, html.dark .p-card, html.dark .p-panel {
  background: var(--soft-card) !important;
  border:1px solid var(--soft-border) !important;
  color: var(--soft-text);
  box-shadow: 0 2px 6px rgba(0,0,0,.35);
}
html.dark h1, html.dark h2, html.dark h3, html.dark h4, html.dark h5, html.dark h6, html.dark label { color: var(--soft-text); }
html.dark .muted { color: var(--soft-muted); }

html.dark .p-inputtext,
html.dark .p-inputnumber-input,
html.dark .p-datepicker input,
html.dark .p-select .p-select-label {
  background: var(--soft-input) !important;
  color: var(--soft-text) !important;
  border-color: var(--soft-border) !important;
}
html.dark .p-select-panel,
html.dark .p-datepicker,
html.dark .p-overlaypanel,
html.dark .p-confirm-dialog,
html.dark .p-toast {
  background: var(--soft-card) !important;
  color: var(--soft-text) !important;
  border:1px solid var(--soft-border) !important;
  box-shadow: 0 6px 16px rgba(0,0,0,.45);
}

html.dark .p-datatable,
html.dark .p-table,
html.dark .p-datatable-wrapper,
html.dark .p-table-wrapper {
  background: var(--soft-card) !important;
  color: var(--soft-text) !important;
  border:1px solid var(--soft-border) !important;
}
html.dark .p-datatable thead > tr > th,
html.dark .p-table thead > tr > th {
  background: var(--soft-bg-2) !important;
  color: var(--soft-text) !important;
  border-color: var(--soft-border) !important;
}
html.dark .p-datatable tbody > tr > td,
html.dark .p-table tbody > tr > td {
  background: var(--soft-card) !important;
  color: var(--soft-text) !important;
  border-color: var(--soft-border) !important;
}
html.dark .p-datatable tbody > tr:hover > td,
html.dark .p-table   tbody > tr:hover > td { background: var(--soft-row-hover) !important; }

/* ================================
   PrimeNG Select (aires y legibilidad)
   ================================ */
.p-select .p-select-label { padding-right: 1.5rem; }
.p-select .p-select-clear-icon { margin-left: .75rem; margin-right: .5rem; font-size: 1rem; opacity: .8; }
